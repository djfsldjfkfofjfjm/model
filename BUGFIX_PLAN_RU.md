# План исправления найденных проблем

Ниже перечислены выявленные в проекте проблемы и баги, а также предлагается поэтапный план их устранения. Все пункты описаны на русском языке в соответствии с запросом.

## Выявленные проблемы

1. **Неиспользуемый код**
   - `src/FinancialDashboard.tsx` — старая версия компонента, не подключается в приложении.
   - `backups/FinancialDashboard.tsx.bak` — резервная копия того же файла.
   - `server.log` — лог разработки на ~1500 строк, занимает место в репозитории.
2. **Невыполняющиеся тесты**
   - Запуск `npm test` завершается ошибкой `react-scripts not found`. В окружении отсутствуют установленные зависимости.
3. **Предупреждения TypeScript/React**
   - В `CLAUDE.md` отмечены неоднозначные типы и пропущенные зависимости `useCallback`. Нужно проверить все файлы.
4. **Закомментированные вызовы `calculateFinancialModel`**
   - В `FinancialContext.tsx` множество сеттеров не вызывают пересчёт модели напрямую (вызывается лишь через `useEffect`). Это усложняет отслеживание обновлений.
5. **Минимальное описание в README**
   - Отсутствует инструкция по установке зависимостей и запуску проекта.
6. **Недостаток тестов для новых компонентов**
   - В `tests` отсутствуют проверки для `ClientsEditor`, `FOTEditor` и большей части бизнес‑логики.

## План исправления

1. **Очистка репозитория**
   - Удалить файлы `src/FinancialDashboard.tsx`, `backups/FinancialDashboard.tsx.bak` и `server.log`.
   - Добавить эти пути в `.gitignore`, чтобы файлы не попадали в репозиторий снова.
2. **Настройка окружения**
   - Выполнить `npm install` для установки зависимостей.
   - Проверить запуск `npm start` и убедиться, что приложение поднимается без ошибок.
3. **Проверка и исправление типов**
   - Просмотреть все компоненты и хук `useFinancialModel` на наличие `any` или пропущенных зависимостей в `useEffect`/`useCallback`.
   - При необходимости добавить типизацию и корректные списки зависимостей.
4. **Упрощение логики пересчёта**
   - Рассмотреть вариант вызова `calculateFinancialModel` непосредственно в сеттерах контекста вместо одной большой зависимости в `useEffect`. Это сделает расчёты более очевидными и позволит писать unit‑тесты на каждый сеттер.
5. **Дополнение README**
   - Добавить раздел «Установка и запуск», описать команды `npm install`, `npm start`, `npm test`.
6. **Расширение тестового покрытия**
   - Написать unit‑тесты для `ClientsEditor`, `FOTEditor` и `UpsellSettingsPanel`.
   - Добавить интеграционные тесты для проверки корректности расчётов при изменении различных параметров.
7. **Проверка корректности расчётов**
   - Используя существующий тест `calculateFinancialModel.test.ts`, добавить кейсы с граничными значениями и нестандартными сценариями (ноль клиентов, высокий churn и т. д.).
   - После исправления багов убедиться, что все тесты проходят.

Выполнение указанных шагов позволит привести проект к рабочему состоянию и гарантировать корректность финансовых расчётов.
